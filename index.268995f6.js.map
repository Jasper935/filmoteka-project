{"mappings":"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","sources":["src/js/api/fetchApi.js","src/js/pagination.js","src/index.js"],"sourcesContent":["export { fetchTrends, fetchByName, fetchGenres };\nconst key = 'fdee5313a0b876498560bfe4baaab806';\nfunction fetchByName(name, page = 1) {\n  const url = `https://api.themoviedb.org/3/search/movie?`;\n\n  return fetch(\n    `${url}api_key=${key}&language=en-US&page=${page}&include_adult=false&query=${name}`\n  )\n    .then(res => res.json())\n    .catch(err => console.log(err));\n}\n\nfunction fetchTrends(page = 1) {\n  if (!page) {\n    page = 1;\n  }\n\n  return fetch(\n\n    `https://api.themoviedb.org/3/trending/movie/day?api_key=${key}&page=${page}&language=en-US`\n\n  ).then(res => res.json());\n  // .then(res=>console.log(res)).catch(err=>console.log(err))\n}\n\n// https://api.themoviedb.org/3/search/movie?${key}&query=${name}&page=1&include_adult=false\nfunction fetchGenres() {\n  return fetch(\n    `https://api.themoviedb.org/3/genre/movie/list?language=en-US&api_key=fdee5313a0b876498560bfe4baaab806`\n  )\n    .then(res => res.json())\n    .catch(err => console.log(err));\n}\n","import { fetchTrends, fetchByName } from './api/fetchApi';\nimport { markUpForGallery } from '/src/index';\nconst paginList = document.querySelector('.pagination__list');\nconst paginBlock = document.querySelector('.pagination');\nconst prevBtn = document.querySelector('.pagination__btn-prev');\nconst nextBtn = document.querySelector('.pagination__btn-next');\nconst PAGE = 'page';\n\nlet currentPage = Number(JSON.parse(localStorage.getItem(PAGE))) || 1;\nlet totalPages;\nlet searchName = null;\n\nfunction changeCurrentPage(page) {\n  localStorage.setItem(PAGE, JSON.stringify(page));\n  currentPage = Number(JSON.parse(localStorage.getItem(PAGE)));\n}\n\n// function firstPaginationCall(pages, response) {\n//   markUpForGallery(response);\n//   paginationMarkup(currentPage, pages);\n// }\n\nfunction paginationMarkup(page, pages, name = null) {\n  changeCurrentPage(page);\n  totalPages = Number(pages);\n  searchName = name;\n  paginBlock.removeEventListener('click', onClickPagination);\n  let markup = '';\n  if (currentPage >= 1) {\n    markup += `<li class=\"pagination__item\">1</li>`;\n  }\n  if (currentPage === 2) {\n    markup += '<li class=\"pagination__item\">2</li>';\n  }\n  if (currentPage === 3) {\n    markup +=\n      '<li class=\"pagination__item\">2</li><li class=\"pagination__item\">3</li>';\n  }\n  if (currentPage === 4) {\n    markup += `<li class=\"pagination__item-hidden is-hidden\"><span>...</span></li><li class=\"pagination__item\">2</li><li class=\"pagination__item\">3</li><li class=\"pagination__item\">4</li>`;\n  }\n  if (currentPage > 4) {\n    markup += `<li class=\"pagination__item-hidden\"><span>...</span></li><li class=\"pagination__item\">${\n      currentPage - 2\n    }</li><li class=\"pagination__item\">${\n      currentPage - 1\n    }</li><li class=\"pagination__item\">${currentPage}</li>`;\n  }\n  if (totalPages - currentPage >= 4) {\n    markup += `<li class=\"pagination__item\">${\n      currentPage + 1\n    }</li><li class=\"pagination__item\">${\n      currentPage + 2\n    }</li><li class=\"pagination__item-hidden\"><span>...</span></li>`;\n  }\n  if (totalPages - currentPage === 3) {\n    markup += `<li class=\"pagination__item\">${\n      currentPage + 1\n    }</li><li class=\"pagination__item\">${\n      currentPage + 2\n    }</li><li class=\"pagination__item-hidden is-hidden\"><span>...</span></li>`;\n  }\n  if (totalPages - currentPage === 2) {\n    markup += `<li class=\"pagination__item\">${currentPage + 1}</li>`;\n  }\n  if (totalPages - currentPage === 0) {\n    paginList.innerHTML = markup;\n    addEdgeClass();\n    addCurrentClassBtn();\n    isEdgePage();\n    paginBlock.addEventListener('click', onClickPagination);\n    return;\n  }\n  markup += `<li class=\"pagination__item\">${totalPages}</li>`;\n  paginList.innerHTML = markup;\n  addEdgeClass();\n  addCurrentClassBtn();\n  isEdgePage();\n  paginBlock.addEventListener('click', onClickPagination);\n}\n\nfunction onClickPagination(evt) {\n  if (evt.target.nodeName === 'BUTTON') {\n    if (evt.target.dataset.btn === 'prev') {\n      changeCurrentPage(currentPage - 1);\n      sendRequest();\n    }\n    if (evt.target.dataset.btn === 'next') {\n      console.log('~ currentPage', currentPage);\n      changeCurrentPage(currentPage + 1);\n      sendRequest();\n    }\n  }\n  if (\n    evt.target.nodeName !== 'LI' ||\n    evt.target.classList.contains('pagination__item-hidden')\n  ) {\n    return;\n  }\n  if (String(currentPage) === evt.target.textContent) {\n    return;\n  }\n  changeCurrentPage(evt.target.textContent);\n  sendRequest();\n}\n\n// paginationMarkup();\n\nfunction addEdgeClass() {\n  paginList.lastElementChild.classList.add('pagination-edge');\n  if (currentPage > 3) {\n    paginList.firstElementChild.classList.add('pagination-edge');\n  }\n  if (totalPages - currentPage < 3) {\n    paginList.lastElementChild.classList.remove('pagination-edge');\n  }\n}\n\nfunction addCurrentClassBtn() {\n  const list = document.querySelectorAll('.pagination__item');\n  list.forEach(el => {\n    if (el.textContent === String(currentPage)) {\n      el.classList.add('pagination__currentPage');\n    }\n  });\n}\n\nfunction isEdgePage() {\n  if (currentPage === 1) {\n    prevBtn.disabled = true;\n    prevBtn.classList.remove('pagination__btn');\n    prevBtn.classList.add('pagination__btn-Ldisabled');\n  } else {\n    prevBtn.disabled = false;\n    prevBtn.classList.add('pagination__btn');\n    prevBtn.classList.remove('pagination__btn-Ldisabled');\n  }\n\n  if (currentPage === totalPages) {\n    nextBtn.disabled = true;\n    nextBtn.classList.remove('pagination__btn');\n    nextBtn.classList.add('pagination__btn-Rdisabled');\n  } else {\n    nextBtn.disabled = false;\n    nextBtn.classList.add('pagination__btn');\n    nextBtn.classList.remove('pagination__btn-Rdisabled');\n  }\n}\n\nfunction sendRequest() {\n  if (searchName === null) {\n    paginBlock.removeEventListener('click', onClickPagination);\n    fetchTrends(currentPage).then(res => {\n      markUpForGallery(res.results);\n      localStorage.setItem('response', JSON.stringify(res.results));\n      paginationMarkup(res.page, res.total_pages);\n    });\n  } else {\n    paginBlock.removeEventListener('click', onClickPagination);\n    fetchByName(searchName, currentPage).then(res => {\n      markUpForGallery(res.results);\n      localStorage.setItem('response', JSON.stringify(res.results));\n      paginationMarkup(res.page, res.total_pages, searchName);\n    });\n  }\n}\n\nfunction removePagination() {\n  paginBlock.innerHTML = '';\n}\n\nexport { paginationMarkup, firstPaginationCall, removePagination };\n","import { fetchTrends, fetchByName, fetchGenres } from './js/api/fetchApi';\nimport {\n  paginationMarkup,\n  firstPaginationCall,\n  removePagination,\n} from './js/pagination';\nlet findErr = document.querySelector('.form-text');\n\nlet obj1 = {};\nlet forLocalStor;\nconst urlImg = 'https://image.tmdb.org/t/p/w500';\nconst galleryItem = document.querySelector('.gallery');\nconst form = document.querySelector('.form');\nfetchGenres().then(data => {\n  data.genres.map(el => {\n    obj1[el.id] = el.name;\n    localStorage.setItem('genres', JSON.stringify(obj1));\n  });\n});\n\n// (function spin() {\n// galleryItem.innerHTML = '<div class=\"spinner-border\"></div>';\n\n//при загрузке сразу показать спиннеор, файнали использовать.\n\nfetchTrends(JSON.parse(localStorage.getItem('page'))).then(res => {\n  // if (localStorage.getItem('page')) {\n  //   firstPaginationCall(res.total_pages, res.results);\n  // } else {\n  localStorage.setItem('response', JSON.stringify(res.results));\n  markUpForGallery(res.results);\n  paginationMarkup(res.page, res.total_pages);\n  // }\n});\n\nform.addEventListener('submit', onSubmit);\n// })();\n\n\n\nfunction onSubmit(evt) {\n  evt.preventDefault();\n  const query = evt.currentTarget.name.value.trim();\n  if (!query) {\n    removePagination();\n    findErr.classList.remove('visually-hidden');\n    setTimeout(() => {\n      findErr.classList.add('visually-hidden');\n    }, 3000);\n    return;\n  }\n\n  spin();\n  function spin() {\n    galleryItem.innerHTML =\n      '<div class=\"spinner\"><span class=\"spinner__animation\"></span><span class=\"spinner__info\"></span></div>';\n    const spinEl = document.querySelector('.spinner');\n    fetchByName(query)\n      .then(res => {\n        console.log(res.results.length);\n        if (!res.results.length) {\n          removePagination();\n          findErr.classList.remove('visually-hidden');\n          setTimeout(() => {\n            findErr.classList.add('visually-hidden');\n          }, 3000);\n          fetchTrends(1).then(result => {\n            markUpForGallery(result.results);\n          });\n          evt.target.reset();\n          return;\n        }\n        localStorage.setItem('response', JSON.stringify(res.results));\n        markUpForGallery(res.results);\n\n        paginationMarkup(res.page, res.total_pages, query);\n      })\n      .catch(err => {\n        console.log(err);\n      })\n\n      .finally(() => spinEl.classList.add('visually-hidden'));\n  }\n}\n\nfunction markUpForGallery(arr) {\n  galleryItem.innerHTML = '';\n  let a = arr.reduce(\n    (acc, el) =>\n      (acc += `<li id='${el.id}' class=\"gallery__item\" >\n      \n          <img \n            class=\"gallery__img\"\n            src='${\n              el.poster_path\n                ? urlImg + el.poster_path\n                : 'https://s1.hostingkartinok.com/uploads/images/2022/07/40ceaea2e22257d2a139ca5a0c0b8ba9.jpg'\n            }'\n            alt=\"${el.original_title}\"\n            \n          />\n          <div class=\"gallery-text\">\n            <p class=\"gallery-text__title\">${el.original_title}</p>\n            <div class=\"gallery-text__info\">\n\n\n              <p class=\"gallery-text__genre\"> ${\n                el.genre_ids.length\n                  ? el.genre_ids.map(gen => {\n                      return (gen = obj1[gen]);\n                    }).length > 3\n                    ? el.genre_ids\n                        .map(gen => {\n                          return (gen = ' ' + obj1[gen]);\n                        })\n                        .slice(0, 2) + ', Other '\n                    : el.genre_ids.map(gen => {\n                        return (gen = ' ' + obj1[gen]);\n                      })\n                  : 'no genres found'\n              } | ${el.release_date.slice(0, 4)}</p>\n\n                </div>\n                </div>\n                \n                </li>`),\n\n    ``\n  );\n  galleryItem.insertAdjacentHTML('beforeend', a);\n  //<span class=\"gallery-text__rating\">${el.vote_average}</span>\n}\n\nexport { markUpForGallery };\n"],"names":["$20fba14b5e95ec63$var$key","$20fba14b5e95ec63$export$1458d52a14f48ec4","name","page","arguments","length","url","fetch","concat","then","res","json","catch","err","console","log","$20fba14b5e95ec63$export$de059b22708f79a1","$20fba14b5e95ec63$export$e95d448b93b2cdb","$2PzaW","parcelRequire","$b8f9b7833fa37166$var$findErr","document","querySelector","$b8f9b7833fa37166$var$obj1","$b8f9b7833fa37166$var$galleryItem","$b8f9b7833fa37166$var$form","$b8f9b7833fa37166$export$ce6ffd2335f38ebb","arr","innerHTML","a","reduce","acc","el","id","poster_path","original_title","genre_ids","map","gen","slice","release_date","insertAdjacentHTML","fetchGenres","data","genres","localStorage","setItem","JSON","stringify","fetchTrends","parse","getItem","results","$dfaf77c789ce7a24$export$a88ca8237831132f","total_pages","addEventListener","evt","preventDefault","query","currentTarget","value","trim","$dfaf77c789ce7a24$export$69cd83fdda46a886","classList","remove","setTimeout","add","spinEl","fetchByName","result","target","reset","finally","spin","$dfaf77c789ce7a24$var$totalPages","$dfaf77c789ce7a24$var$paginList","$dfaf77c789ce7a24$var$paginBlock","$dfaf77c789ce7a24$var$prevBtn","$dfaf77c789ce7a24$var$nextBtn","$dfaf77c789ce7a24$var$PAGE","$dfaf77c789ce7a24$var$currentPage","Number","$dfaf77c789ce7a24$var$searchName","$dfaf77c789ce7a24$var$changeCurrentPage","pages","removeEventListener","$dfaf77c789ce7a24$var$onClickPagination","markup","$dfaf77c789ce7a24$var$addEdgeClass","$dfaf77c789ce7a24$var$addCurrentClassBtn","$dfaf77c789ce7a24$var$isEdgePage","nodeName","dataset","btn","$dfaf77c789ce7a24$var$sendRequest","contains","String","textContent","lastElementChild","firstElementChild","querySelectorAll","forEach","disabled"],"version":3,"file":"index.268995f6.js.map"}